//------ Читаем документы из локальной таблицы
ДОБАВИТЬКОНТЕКСТ( "SELECT guid, ic, doccode FROM " + ИМЯТАБЛИЦЫ, "СписокДокументов" );
IF ( КОЛИЧЕСТВОСТРОК( "СписокДокументов" ) == 0 )
	СООБЩЕНИЕ( "Не было отмечено ни одного документа в списке." );

ПОКА ( !КОНЕЦКОНТЕКСТА( "СписокДокументов" ) )
{
	Статус	= ЗАПРОС( "SELECT status FROM " + ЕСЛИ( СписокДокументов.doccode == "WOFF", "mark_writeoff", "mark_reciept" ) + " WHERE identity_column = " + СписокДокументов.ic );
	IF ( Статус == 0 AND СписокДокументов.doccode == "WOFF" )
		МАРКИРОВКА.ОТПРАВКАСПИСАНИЯ( ПРЕДПРИЯТИЕ, СписокДокументов.ic );
	IF ( Статус == 0 AND СписокДокументов.doccode == "RPCT" )
		МАРКИРОВКА.ОТПРАВКАВЫБЫТИЯ( ПРЕДПРИЯТИЕ, СписокДокументов.ic );
	ELSE IF ( !ПУСТО( СписокДокументов.guid ) )
		МАРКИРОВКА.ПРОВЕРКАСТАТУСАДОКУМЕНТА( ПРЕДПРИЯТИЕ, СписокДокументов.guid );
		
	ОЖИДАНИЕ( 500 );
	ПРОПУСТИТЬ( 1, "СписокДокументов" );
}
УДАЛИТЬКОНТЕКСТ( "СписокДокументов" );
