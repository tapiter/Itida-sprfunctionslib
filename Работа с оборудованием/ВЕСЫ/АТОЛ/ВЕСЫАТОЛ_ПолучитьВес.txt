//Получить вес из ВЕСОВ БЕЗ ПЭ

ДрайверВесов	= СОЗДАТЬОБЪЕКТ( "AddIn.Scale45", 1 );
IF ( ТИП( "ДрайверВесов" ) <> "O" )
{
	СООБЩЕНИЕ( "Не удалось создать объект драйвера AddIn.Scale45" );
	_ОШИБКАВЫПОЛНЕНИЯ		= true;
	RETURN 0;
}

Вес							= 0.00;

ДрайверВесов.CurrentDeviceNumber = НомерУстройства;

ДрайверВесов.DeviceEnabled = true;
// После этого возможен доступ к свойствам и методам
// Подключаемся к весам
IF ( ДрайверВесов.ResultCode <> 0 )
{
	СООБЩЕНИЕ( ДрайверВесов.ResultDescription, "Не удалось подключить весы" );
	_ОШИБКАВЫПОЛНЕНИЯ		= true;
	ДрайверВесов				= false;
	RETURN 0;
}

ДрайверВесов.ReadWeight( );
IF ( ДрайверВесов.ResultCode <> 0 )
{
	СООБЩЕНИЕ( ДрайверВесов.ResultDescription, "Не удалось получить вес с весов" );
	_ОШИБКАВЫПОЛНЕНИЯ		= true;
	RETURN 0;
}

Вес	= ДрайверВесов.Weight;

ДрайверВесов.DeviceEnabled = false;
ДрайверВесов				= false;

RETURN Вес;
