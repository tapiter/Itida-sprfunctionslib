//Получить вес из ВЕСОВ БЕЗ ПЭ

ДрайверВесов	= СОЗДАТЬОБЪЕКТ( "Cas_AD_AP.Scale", 1 );
IF ( ТИП( "ДрайверВесов" ) <> "O" )
{
	СООБЩЕНИЕ( "Не удалось создать объект драйвера Cas_AD_AP.Scale" );
	_ОШИБКАВЫПОЛНЕНИЯ		= true;
	RETURN 0;
}

ПортВесов = ЗАПРОС("SELECT port_n FROM sprequipment WHERE code = '" + _КОДОБОРУДОВАНИЯ + "'");

Вес							= 0.00;
// После этого возможен доступ к свойствам и методам
// Подключаемся к весам
try
{
	ДрайверВесов.Connect(ПортВесов, 0);
}
catch
{
	СООБЩЕНИЕ( "Не удалось подключится к весам. Проверьте соединение." );
	RETURN 0;
}

WAIT(3000); //ждем 3 секунды после соединения

//пытаемся получить вес
try
{
	ДрайверВесов.UpdateOnlyWeight( );
	Вес	= ДрайверВесов.Weight;
}
catch
{
	СООБЩЕНИЕ( "Ошибка получения веса с весов" );
	//отключаемся
	ДрайверВесов.Disconnect();
	RETURN 0;
}

//отключаемся от весов
try
{
	ДрайверВесов.Disconnect();
}
catch
{
	RETURN 0;
}

ДрайверВесов				= false;
RETURN Вес;
